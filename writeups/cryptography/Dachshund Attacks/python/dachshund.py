from owiener import attack

n = 112751716575052797252462402773735527190510089797451503244556784491319457769107078165570925380290065476740819142717486846746000855348017094076907501987908459309438625722536509640668695393497357073641708668559158929842361922505124601033729644931445527797992117186341766936280129560565669801540583202212112145831

e = 39485145008650107911557888606716405001939520288398991002987307991557688968496516433368907277880327342138878639003095640452483557565748039552256409417988083459906607958884676489964385432551984664437905119603760835507638049083161271225154859909638767286398067700006526284458326297386681514810075177508719700039

c = 58145194552282049953548719750365168635632383487574838595844751612816001705064632965712874605006547556127495708006313201394017878101797756012007636257682241494864713784724000378103415081002406495964926956538769637170309776169654468026220316606934643377033565516047343051478330971734325463877538260785531950457


# Run Wiener attack
d = attack(e, n)

if d is None:
    print("Wiener attack failed.")

else:
    print(f"Recovered d: {d}")

    # Decrypt the ciphertext
    m = pow(c, d, n)
    print("\n[+] Decrypted flag as int:", m)

    # Convert int to bytes
    flag = m.to_bytes((m.bit_length() + 7) // 8, byteorder="big")
    print("[+] Flag:", flag.decode(errors="ignore"))