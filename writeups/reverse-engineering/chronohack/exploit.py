from pwn import *
import random
import time


def get_random(seed, length):
    alphabet = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"
    random.seed(seed)
    s = ""
    for i in range(length):
        s += random.choice(alphabet)
    return s

# התחברות לשרת
p = remote('instance.url.here', 12345)  

p.recvuntil(b"token?") 


current = int(time.time() * 1000)

found = False
for delta in range(-5000, 5000): 
    seed = current + delta
    token = get_random(seed, 20)
    print(f"Trying token: {token}")
    p.sendline(token.encode())
    res = p.recvline()
    if b"Congratulations" in res:
        print(res)
        found = True
        break

if not found:
    print("Token not found in range")

p.interactive()
